(function(a){a.fn.richMenu=function(b){return this.each(function(){var i=a(this);var e;var l=a.extend({},a.fn.richMenu.defaults,b);target=function(){var m=l.target;return m&&m.jquery?m:a(m)};var f=target();f.hide();var c=f.clone(true).data("menuLock",1).appendTo("body");function d(){switch(l.position){case"bottom":c.css({display:"none",position:"absolute",left:i.offset().left,top:i.offset().top+i.height(),zIndex:5000});break;case"top":c.css({display:"none",position:"absolute",left:i.offset().left,top:i.offset().top-c.height(),zIndex:5000});break;case"left":c.css({display:"none",position:"absolute",right:i.offset().left+i.width(),top:i.offset().top,zIndex:5000});break;case"right":c.css({display:"none",position:"absolute",left:i.offset().left+i.width(),top:i.offset().top+i.height(),zIndex:5000});break}}d();a(window).resize(function(){d()});function j(n){if(typeof n=="number"){n=undefined}var m=a(n);clearTimeout(e);if(m.css("display")!="none"){m.removeClass("richMenuActive");switch(l.effect){case"slide":m.slideUp(l.speed);break;case"fade":m.fadeOut(l.speed);break}}}function g(){if(i.data("animating")){return false}h();return false}function h(){i.data("animating",1);c.queue(function(){l.onBefore(c,i);c.dequeue()});if(c.css("display")=="none"){c.addClass("richMenuActive");switch(l.effect){case"slide":c.slideDown(l.speed);break;case"fade":c.fadeIn(l.speed);break}}else{if(l.events=="click"){j(c)}}c.queue(function(){l.onEnd(c,i);i.removeData("animating");c.dequeue()})}c.mouseenter(function(){c.css({zIndex:5000});clearTimeout(e)});c.mouseleave(function(){c.css({zIndex:4999});clearTimeout(e);e=setTimeout(function(){j(c)},l.timeout);e});i.mouseenter(function(){c.css({zIndex:5000});clearTimeout(e)});i.mouseleave(function(){c.css({zIndex:4999});clearTimeout(e);e=setTimeout(function(){j(c)},l.timeout);e});function k(m){a(m).children().each(function(){k(a(this))})}i.bind(a.trim((l.events+" ").split(" ").join(".newmenu ")),g);k(c)})};a.fn.richMenu.defaults={events:"click",effect:"slide",target:null,timeout:500,speed:"fast",position:"bottom",onBefore:function(){},onEnd:function(){}}})(jQuery);