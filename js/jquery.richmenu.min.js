(function(a){a.fn.richMenu=function(b){return this.each(function(){var i=a(this);var e;var m={events:b.events||"click",effect:b.effect||"slide",target:b.target||null,timeout:b.timeout||500,speed:b.speed||"fast",position:b.position||"bottom",onBefore:b.onBefore||function(){},onEnd:b.onEnd||function(){},onClick:b.onClick||function(){}};target=function(){var n=m.target;return n&&n.jquery?n:a(n)};var f=target();f.hide();var c=f.clone(true).data("menuLock",1).appendTo("body");function d(){switch(m.position){case"bottom":c.css({display:"none",position:"absolute",left:i.offset().left,top:i.offset().top+i.height(),zIndex:5000});break;case"top":c.css({display:"none",position:"absolute",left:i.offset().left,top:i.offset().top-c.height(),zIndex:5000});break;case"left":c.css({display:"none",position:"absolute",right:i.offset().left+i.width(),top:i.offset().top,zIndex:5000});break;case"right":c.css({display:"none",position:"absolute",left:i.offset().left+i.width(),top:i.offset().top+i.height(),zIndex:5000});break}}d();a(window).resize(function(){d()});function j(o){if(typeof o=="number"){o=undefined}var n=a(o);clearTimeout(e);if(n.css("display")!="none"){n.removeClass("richMenuActive");switch(m.effect){case"slide":n.slideUp(m.speed);break;case"fade":n.fadeOut(m.speed);break}}}function g(){if(i.data("animating")){return false}h();return false}function h(){i.data("animating",1);c.queue(function(){a(".richMenuActive").each(function(n,o){});m.onBefore(c,this);c.dequeue()});if(c.css("display")=="none"){c.addClass("richMenuActive");switch(m.effect){case"slide":c.slideDown(m.speed);break;case"fade":c.fadeIn(m.speed);break}}else{if(m.events=="click"){j(c)}}c.queue(function(){m.onEnd(c,i);i.removeData("animating");c.dequeue()})}function l(n){m.onClick(this,c,i,n);j(c);n.stopPropagation()}c.mouseenter(function(){c.css({zIndex:5000});clearTimeout(e)});c.mouseleave(function(){c.css({zIndex:4999});clearTimeout(e);e=setTimeout(function(){j(c)},m.timeout);e});i.mouseenter(function(){c.css({zIndex:5000});clearTimeout(e)});i.mouseleave(function(){c.css({zIndex:4999});clearTimeout(e);e=setTimeout(function(){j(c)},m.timeout);e});function k(n){a(n).bind("click",l,false);a(n).children().each(function(){k(a(this))})}i.bind(a.trim((m.events+" ").split(" ").join(".newmenu ")),g);k(c)})}})(jQuery);